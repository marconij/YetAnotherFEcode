function model = mems_ts1_model(p, plot_geom)

if nargin == 0
    p = zeros(8,1);
    plot_geom = true;
elseif nargin == 1
    plot_geom = true;
end

if length(p)~=8
    error('p must contain the lenghts of the 8 beams')
end

% Rigid body shapes
% top-left CB-beam
xy{1} = [-126.2641	-126.2641	-115.4641	-115.4641	-112.4641	-112.4641	-94.4641	-94.4641	-91.4641	-91.4641	-73.4641	-73.4641	-70.4641	-70.4641	-52.4641	-52.4641	-49.4641	-49.4641	-126.2641	-126.2641	-115.4641	-115.4641	-112.4641	-112.4641	-126.2641	-126.2641	-115.4641	-115.4641	-112.4641	-112.4641	-126.2641	-126.2641	-192.8641	-192.8641	-178.4641	-178.4641	-175.4641	-175.4641	-157.4641	-157.4641	-154.4641	-154.4641	-136.4641	-136.4641	-133.4641	-133.4641	-115.4641	-115.4641	-112.4641	-112.4641	-192.8641	-192.8641	-101.6641	-101.6641	-35.0641	-35.0641
          190.3766	204.1766	204.1766	201.1766	201.1766	204.1766	204.1766	201.1766	201.1766	204.1766	204.1766	201.1766	201.1766	204.1766	204.1766	201.1766	201.1766	204.1766	204.1766	224.7766	224.7766	221.7766	221.7766	224.7766	224.7766	247.4766	247.4766	244.4766	244.4766	247.4766	247.4766	257.0766	257.0766	270.8766	270.8766	267.8766	267.8766	270.8766	270.8766	267.8766	267.8766	270.8766	270.8766	267.8766	267.8766	270.8766	270.8766	267.8766	267.8766	270.8766	270.8766	281.6766	281.6766	214.9766	214.9766	190.3766]';

% top-right CB-beam
xy{2} = [47.1359	64.5359	64.5359	61.5359	61.5359	64.5359	64.5359	85.5359	85.5359	82.5359	82.5359	85.5359	85.5359	106.5359	106.5359	103.5359	103.5359	106.5359	106.5359	127.5359	127.5359	124.5359	124.5359	127.5359	127.5359	124.5359	124.5359	127.5359	127.5359	124.5359	124.5359	127.5359	127.5359	124.5359	124.5359	127.5359	127.5359	138.3359	138.3359	148.5359	148.5359	145.5359	145.5359	148.5359	148.5359	169.5359	169.5359	166.5359	166.5359	169.5359	169.5359	190.5359	190.5359	187.5359	187.5359	190.5359	190.5359	204.9359	204.9359	113.7359	113.7359	47.1359
        190.3766	190.3766	201.1766	201.1766	204.1766	204.1766	190.3766	190.3766	201.1766	201.1766	204.1766	204.1766	190.3766	190.3766	201.1766	201.1766	204.1766	204.1766	190.3766	190.3766	201.1766	201.1766	204.1766	204.1766	221.7766	221.7766	224.7766	224.7766	244.4766	244.4766	247.4766	247.4766	267.8766	267.8766	270.8766	270.8766	190.3766	190.3766	257.0766	257.0766	267.8766	267.8766	270.8766	270.8766	257.0766	257.0766	267.8766	267.8766	270.8766	270.8766	257.0766	257.0766	267.8766	267.8766	270.8766	270.8766	257.0766	257.0766	281.6766	281.6766	214.9766	214.9766]';

% bottom-left CB-beam
xy{3} = [47.1359	64.5359	64.5359	61.5359	61.5359	64.5359	64.5359	85.5359	85.5359	82.5359	82.5359	85.5359	85.5359	106.5359	106.5359	103.5359	103.5359	106.5359	106.5359	127.5359	127.5359	124.5359	124.5359	127.5359	127.5359	124.5359	124.5359	127.5359	127.5359	124.5359	124.5359	127.5359	127.5359	124.5359	124.5359	127.5359	127.5359	138.3359	138.3359	148.5359	148.5359	145.5359	145.5359	148.5359	148.5359	169.5359	169.5359	166.5359	166.5359	169.5359	169.5359	190.5359	190.5359	187.5359	187.5359	190.5359	190.5359	204.9359	204.9359	113.7359	113.7359	47.1359
       -179.2234	-179.2234	-190.0234	-190.0234	-193.0234	-193.0234	-179.2234	-179.2234	-190.0234	-190.0234	-193.0234	-193.0234	-179.2234	-179.2234	-190.0234	-190.0234	-193.0234	-193.0234	-179.2234	-179.2234	-190.0234	-190.0234	-193.0234	-193.0234	-210.6234	-210.6234	-213.6234	-213.6234	-233.3234	-233.3234	-236.3234	-236.3234	-256.7234	-256.7234	-259.7234	-259.7234	-179.2234	-179.2234	-245.9234	-245.9234	-256.7234	-256.7234	-259.7234	-259.7234	-245.9234	-245.9234	-256.7234	-256.7234	-259.7234	-259.7234	-245.9234	-245.9234	-256.7234	-256.7234	-259.7234	-259.7234	-245.9234	-245.9234	-270.5234	-270.5234	-203.8234	-203.8234]';

% bottom-right CB-beam
xy{4} = [-35.0641	-52.4641	-52.4641	-49.4641	-49.4641	-52.4641	-52.4641	-73.4641	-73.4641	-70.4641	-70.4641	-73.4641	-73.4641	-94.4641	-94.4641	-91.4641	-91.4641	-94.4641	-94.4641	-115.4641	-115.4641	-112.4641	-112.4641	-115.4641	-115.4641	-112.4641	-112.4641	-115.4641	-115.4641	-112.4641	-112.4641	-115.4641	-115.4641	-112.4641	-112.4641	-115.4641	-115.4641	-126.2641	-126.2641	-136.4641	-136.4641	-133.4641	-133.4641	-136.4641	-136.4641	-157.4641	-157.4641	-154.4641	-154.4641	-157.4641	-157.4641	-178.4641	-178.4641	-175.4641	-175.4641	-178.4641	-178.4641	-192.8641	-192.8641	-101.6641	-101.6641	-35.0641
        -179.2234	-179.2234	-190.0234	-190.0234	-193.0234	-193.0234	-179.2234	-179.2234	-190.0234	-190.0234	-193.0234	-193.0234	-179.2234	-179.2234	-190.0234	-190.0234	-193.0234	-193.0234	-179.2234	-179.2234	-190.0234	-190.0234	-193.0234	-193.0234	-210.6234	-210.6234	-213.6234	-213.6234	-233.3234	-233.3234	-236.3234	-236.3234	-256.7234	-256.7234	-259.7234	-259.7234	-179.2234	-179.2234	-245.9234	-245.9234	-256.7234	-256.7234	-259.7234	-259.7234	-245.9234	-245.9234	-256.7234	-256.7234	-259.7234	-259.7234	-245.9234	-245.9234	-256.7234	-256.7234	-259.7234	-259.7234	-245.9234	-245.9234	-270.5234	-270.5234	-203.8234	-203.8234]';

% central mass
xy{5} = [-186.5641	-186.5641	-186.6641	-186.8641	-187.1641	-187.5641	-188.0641	-188.5641	-198.5641	-198.5641	-224.3641	-224.3641	-185.4641	-185.4641	-182.4641	-182.4641	194.5359	194.5359	197.5359	197.5359	-224.3641	-224.3641	-206.9641	-206.9641	-205.3641	-205.3641	-200.7641	-200.7641	-198.3641	-198.3641	-193.7641	-193.7641	-191.3641	-191.3641	-186.7641	-186.7641	-184.3641	-184.3641	-179.7641	-179.7641	-177.3641	-177.3641	-172.7641	-172.7641	-170.3641	-170.3641	-165.7641	-165.7641	-163.3641	-163.3641	-158.7641	-158.7641	-156.3641	-156.3641	-151.7641	-151.7641	-149.3641	-149.3641	-144.7641	-144.7641	-142.3641	-142.3641	-137.7641	-137.7641	-135.3641	-135.3641	-130.7641	-130.7641	-128.3641	-128.3641	-123.7641	-123.7641	-121.3641	-121.3641	-116.7641	-116.7641	-114.3641	-114.3641	-109.7641	-109.7641	-107.3641	-107.3641	-102.7641	-102.7641	-100.3641	-100.3641	-95.7641	-95.7641	-93.3641	-93.3641	-88.7641	-88.7641	-86.3641	-86.3641	-81.7641	-81.7641	-79.3641	-79.3641	-74.7641	-74.7641	-72.3641	-72.3641	-67.7641	-67.7641	-65.3641	-65.3641	-60.7641	-60.7641	-58.3641	-58.3641	-53.7641	-53.7641	-51.3641	-51.3641	-46.7641	-46.7641	-44.3641	-44.3641	-39.7641	-39.7641	-37.3641	-37.3641	-32.7641	-32.7641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	-32.7641	-32.7641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	-32.7641	-32.7641	-31.1641	-31.1641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	-31.1641	-31.1641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	-31.1641	-31.1641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	-31.1641	-31.1641	43.2359	43.2359	44.8359	44.8359	49.4359	49.4359	51.8359	51.8359	56.4359	56.4359	58.8359	58.8359	63.4359	63.4359	65.8359	65.8359	70.4359	70.4359	72.8359	72.8359	77.4359	77.4359	79.8359	79.8359	84.4359	84.4359	86.8359	86.8359	91.4359	91.4359	93.8359	93.8359	98.4359	98.4359	100.8359	100.8359	105.4359	105.4359	107.8359	107.8359	112.4359	112.4359	114.8359	114.8359	119.4359	119.4359	121.8359	121.8359	126.4359	126.4359	128.8359	128.8359	133.4359	133.4359	135.8359	135.8359	140.4359	140.4359	142.8359	142.8359	147.4359	147.4359	149.8359	149.8359	154.4359	154.4359	156.8359	156.8359	161.4359	161.4359	163.8359	163.8359	168.4359	168.4359	170.8359	170.8359	175.4359	175.4359	177.8359	177.8359	182.4359	182.4359	184.8359	184.8359	189.4359	189.4359	191.8359	191.8359	196.4359	196.4359	198.8359	198.8359	203.4359	203.4359	205.8359	205.8359	210.4359	210.4359	212.8359	212.8359	217.4359	217.4359	219.0359	219.0359	-224.3641	-224.3641	-216.3641	-216.3641	-213.3641	-213.3641	225.4359	225.4359	228.4359	228.4359	-224.3641	-224.3641	-101.5641	-101.5641	-98.5641	-98.5641	-85.4641	-85.4641	-82.4641	-82.4641	-69.3641	-69.3641	-66.3641	-66.3641	-53.2641	-53.2641	-50.2641	-50.2641	-37.1641	-37.1641	-34.1641	-34.1641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	46.2359	46.2359	49.2359	49.2359	62.3359	62.3359	65.3359	65.3359	78.4359	78.4359	81.4359	81.4359	94.5359	94.5359	97.5359	97.5359	110.6359	110.6359	113.6359	113.6359	-224.3641	-224.3641	-206.9641	-206.9641	-115.1641	-115.1641	-101.5641	-101.5641	-98.5641	-98.5641	-85.4641	-85.4641	-82.4641	-82.4641	-69.3641	-69.3641	-66.3641	-66.3641	-53.2641	-53.2641	-50.2641	-50.2641	-37.1641	-37.1641	-34.1641	-34.1641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	46.2359	46.2359	49.2359	49.2359	62.3359	62.3359	65.3359	65.3359	78.4359	78.4359	81.4359	81.4359	94.5359	94.5359	97.5359	97.5359	110.6359	110.6359	113.6359	113.6359	-115.1641	-115.1641	-101.5641	-101.5641	-98.5641	-98.5641	-85.4641	-85.4641	-82.4641	-82.4641	-69.3641	-69.3641	-66.3641	-66.3641	-53.2641	-53.2641	-50.2641	-50.2641	-37.1641	-37.1641	-34.1641	-34.1641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	46.2359	46.2359	49.2359	49.2359	62.3359	62.3359	65.3359	65.3359	78.4359	78.4359	81.4359	81.4359	94.5359	94.5359	97.5359	97.5359	110.6359	110.6359	113.6359	113.6359	-115.1641	-115.1641	-101.5641	-101.5641	-98.5641	-98.5641	-85.4641	-85.4641	-82.4641	-82.4641	-69.3641	-69.3641	-66.3641	-66.3641	-53.2641	-53.2641	-50.2641	-50.2641	-37.1641	-37.1641	-34.1641	-34.1641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	46.2359	46.2359	49.2359	49.2359	62.3359	62.3359	65.3359	65.3359	78.4359	78.4359	81.4359	81.4359	94.5359	94.5359	97.5359	97.5359	110.6359	110.6359	113.6359	113.6359	-115.1641	-115.1641	-224.3641	-224.3641	-101.5641	-101.5641	-98.5641	-98.5641	-85.4641	-85.4641	-82.4641	-82.4641	-69.3641	-69.3641	-66.3641	-66.3641	-53.2641	-53.2641	-50.2641	-50.2641	-37.1641	-37.1641	-34.1641	-34.1641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	46.2359	46.2359	49.2359	49.2359	62.3359	62.3359	65.3359	65.3359	78.4359	78.4359	81.4359	81.4359	94.5359	94.5359	97.5359	97.5359	110.6359	110.6359	113.6359	113.6359	127.2359	127.2359	219.0359	219.0359	113.6359	113.6359	-224.3641	-224.3641	-215.3641	-215.3641	-212.3641	-212.3641	224.4359	224.4359	227.4359	227.4359	-224.3641	-224.3641	-206.9641	-206.9641	-115.1641	-115.1641	-101.5641	-101.5641	-98.5641	-98.5641	-85.4641	-85.4641	-82.4641	-82.4641	-69.3641	-69.3641	-66.3641	-66.3641	-53.2641	-53.2641	-50.2641	-50.2641	-37.1641	-37.1641	-34.1641	-34.1641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	46.2359	46.2359	49.2359	49.2359	62.3359	62.3359	65.3359	65.3359	78.4359	78.4359	81.4359	81.4359	94.5359	94.5359	97.5359	97.5359	110.6359	110.6359	113.6359	113.6359	-115.1641	-115.1641	-101.5641	-101.5641	-98.5641	-98.5641	-85.4641	-85.4641	-82.4641	-82.4641	-69.3641	-69.3641	-66.3641	-66.3641	-53.2641	-53.2641	-50.2641	-50.2641	-37.1641	-37.1641	-34.1641	-34.1641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	46.2359	46.2359	49.2359	49.2359	62.3359	62.3359	65.3359	65.3359	78.4359	78.4359	81.4359	81.4359	94.5359	94.5359	97.5359	97.5359	110.6359	110.6359	113.6359	113.6359	-115.1641	-115.1641	-101.5641	-101.5641	-98.5641	-98.5641	-85.4641	-85.4641	-82.4641	-82.4641	-69.3641	-69.3641	-66.3641	-66.3641	-53.2641	-53.2641	-50.2641	-50.2641	-37.1641	-37.1641	-34.1641	-34.1641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	46.2359	46.2359	49.2359	49.2359	62.3359	62.3359	65.3359	65.3359	78.4359	78.4359	81.4359	81.4359	94.5359	94.5359	97.5359	97.5359	110.6359	110.6359	113.6359	113.6359	-115.1641	-115.1641	-101.5641	-101.5641	-98.5641	-98.5641	-85.4641	-85.4641	-82.4641	-82.4641	-69.3641	-69.3641	-66.3641	-66.3641	-53.2641	-53.2641	-50.2641	-50.2641	-37.1641	-37.1641	-34.1641	-34.1641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	46.2359	46.2359	49.2359	49.2359	62.3359	62.3359	65.3359	65.3359	78.4359	78.4359	81.4359	81.4359	94.5359	94.5359	97.5359	97.5359	110.6359	110.6359	113.6359	113.6359	-115.1641	-115.1641	127.2359	127.2359	219.0359	219.0359	-224.3641	-224.3641	-101.5641	-101.5641	-98.5641	-98.5641	-85.4641	-85.4641	-82.4641	-82.4641	-69.3641	-69.3641	-66.3641	-66.3641	-53.2641	-53.2641	-50.2641	-50.2641	-37.1641	-37.1641	-34.1641	-34.1641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	46.2359	46.2359	49.2359	49.2359	62.3359	62.3359	65.3359	65.3359	78.4359	78.4359	81.4359	81.4359	94.5359	94.5359	97.5359	97.5359	110.6359	110.6359	113.6359	113.6359	-224.3641	-224.3641	-216.3641	-216.3641	-213.3641	-213.3641	225.4359	225.4359	228.4359	228.4359	-224.3641	-224.3641	-206.9641	-206.9641	-205.3641	-205.3641	-200.7641	-200.7641	-198.3641	-198.3641	-193.7641	-193.7641	-191.3641	-191.3641	-186.7641	-186.7641	-184.3641	-184.3641	-179.7641	-179.7641	-177.3641	-177.3641	-172.7641	-172.7641	-170.3641	-170.3641	-165.7641	-165.7641	-163.3641	-163.3641	-158.7641	-158.7641	-156.3641	-156.3641	-151.7641	-151.7641	-149.3641	-149.3641	-144.7641	-144.7641	-142.3641	-142.3641	-137.7641	-137.7641	-135.3641	-135.3641	-130.7641	-130.7641	-128.3641	-128.3641	-123.7641	-123.7641	-121.3641	-121.3641	-116.7641	-116.7641	-114.3641	-114.3641	-109.7641	-109.7641	-107.3641	-107.3641	-102.7641	-102.7641	-100.3641	-100.3641	-95.7641	-95.7641	-93.3641	-93.3641	-88.7641	-88.7641	-86.3641	-86.3641	-81.7641	-81.7641	-79.3641	-79.3641	-74.7641	-74.7641	-72.3641	-72.3641	-67.7641	-67.7641	-65.3641	-65.3641	-60.7641	-60.7641	-58.3641	-58.3641	-53.7641	-53.7641	-51.3641	-51.3641	-46.7641	-46.7641	-44.3641	-44.3641	-39.7641	-39.7641	-37.3641	-37.3641	-32.7641	-32.7641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	-32.7641	-32.7641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	-32.7641	-32.7641	-31.1641	-31.1641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	-31.1641	-31.1641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	-31.1641	-31.1641	-224.3641	-224.3641	-21.0641	-21.0641	-18.0641	-18.0641	-4.9641	-4.9641	-1.2641	-1.2641	13.3359	13.3359	17.0359	17.0359	30.1359	30.1359	33.1359	33.1359	43.2359	43.2359	44.8359	44.8359	49.4359	49.4359	51.8359	51.8359	56.4359	56.4359	58.8359	58.8359	63.4359	63.4359	65.8359	65.8359	70.4359	70.4359	72.8359	72.8359	77.4359	77.4359	79.8359	79.8359	84.4359	84.4359	86.8359	86.8359	91.4359	91.4359	93.8359	93.8359	98.4359	98.4359	100.8359	100.8359	105.4359	105.4359	107.8359	107.8359	112.4359	112.4359	114.8359	114.8359	119.4359	119.4359	121.8359	121.8359	126.4359	126.4359	128.8359	128.8359	133.4359	133.4359	135.8359	135.8359	140.4359	140.4359	142.8359	142.8359	147.4359	147.4359	149.8359	149.8359	154.4359	154.4359	156.8359	156.8359	161.4359	161.4359	163.8359	163.8359	168.4359	168.4359	170.8359	170.8359	175.4359	175.4359	177.8359	177.8359	182.4359	182.4359	184.8359	184.8359	189.4359	189.4359	191.8359	191.8359	196.4359	196.4359	198.8359	198.8359	203.4359	203.4359	205.8359	205.8359	210.4359	210.4359	212.8359	212.8359	217.4359	217.4359	219.0359	219.0359	33.1359	33.1359	-224.3641	-224.3641	-185.4641	-185.4641	-182.4641	-182.4641	194.5359	194.5359	197.5359	197.5359	-224.3641	-224.3641	-198.5641	-198.5641	-188.5641	-188.0641	-187.5641	-187.1641	-186.8641	-186.6641	-186.5641	-186.5641	-181.3641	-181.3641	-181.2641	-181.0641	-180.7641	-180.3641	-179.8641	-179.3641	-169.3641	-169.3641	-24.4641	-24.4641	36.5359	36.5359	181.4359	181.4359	191.4359	191.9359	192.4359	192.8359	193.1359	193.3359	193.4359	193.4359	198.6359	198.6359	198.7359	198.9359	199.2359	199.6359	200.1359	200.6359	210.6359	210.6359	236.4359	236.4359	210.6359	210.6359	200.6359	200.1359	199.6359	199.2359	198.9359	198.7359	198.6359	198.6359	193.4359	193.4359	193.3359	193.1359	192.8359	192.4359	191.9359	191.4359	181.4359	181.4359	-169.3641	-169.3641	-179.3641	-179.8641	-180.3641	-180.7641	-181.0641	-181.2641	-181.3641	-181.3641
         -180.7234	-178.7234	-178.2234	-177.7234	-177.3234	-177.0234	-176.8234	-176.7234	-176.7234	-168.8234	-168.8234	-161.0234	-161.0234	-164.0234	-164.0234	-161.0234	-161.0234	-164.0234	-164.0234	-161.0234	-161.0234	-85.3234	-85.3234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-153.9234	-153.9234	-156.9234	-156.9234	-153.9234	-153.9234	-156.9234	-156.9234	-153.9234	-153.9234	-156.9234	-156.9234	-153.9234	-153.9234	-156.9234	-156.9234	-153.9234	-153.9234	-137.6234	-137.6234	-140.6234	-140.6234	-137.6234	-137.6234	-140.6234	-140.6234	-137.6234	-137.6234	-140.6234	-140.6234	-137.6234	-137.6234	-140.6234	-140.6234	-137.6234	-137.6234	-130.5234	-130.5234	-121.3234	-121.3234	-124.3234	-124.3234	-121.3234	-121.3234	-124.3234	-124.3234	-121.3234	-121.3234	-124.3234	-124.3234	-121.3234	-121.3234	-124.3234	-124.3234	-121.3234	-121.3234	-105.0234	-105.0234	-108.0234	-108.0234	-105.0234	-105.0234	-108.0234	-108.0234	-105.0234	-105.0234	-108.0234	-108.0234	-105.0234	-105.0234	-108.0234	-108.0234	-105.0234	-105.0234	-88.7234	-88.7234	-91.7234	-91.7234	-88.7234	-88.7234	-91.7234	-91.7234	-88.7234	-88.7234	-91.7234	-91.7234	-88.7234	-88.7234	-91.7234	-91.7234	-88.7234	-88.7234	-85.3234	-85.3234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-154.5234	-154.5234	-130.5234	-130.5234	-85.3234	-85.3234	-76.7234	-76.7234	-79.7234	-79.7234	-76.7234	-76.7234	-79.7234	-79.7234	-76.7234	-76.7234	-72.4234	-72.4234	-75.4234	-75.4234	-72.4234	-72.4234	-75.4234	-75.4234	-72.4234	-72.4234	-75.4234	-75.4234	-72.4234	-72.4234	-75.4234	-75.4234	-72.4234	-72.4234	-75.4234	-75.4234	-72.4234	-72.4234	-75.4234	-75.4234	-72.4234	-72.4234	-75.4234	-75.4234	-72.4234	-72.4234	-75.4234	-75.4234	-72.4234	-72.4234	-75.4234	-75.4234	-72.4234	-72.4234	-75.4234	-75.4234	-72.4234	-72.4234	-75.4234	-75.4234	-72.4234	-72.4234	-75.4234	-75.4234	-72.4234	-72.4234	-75.4234	-75.4234	-72.4234	-72.4234	-75.4234	-75.4234	-72.4234	-72.4234	-1.8234	-1.8234	-71.0234	-71.0234	-54.9234	-54.9234	-57.9234	-57.9234	-54.9234	-54.9234	-57.9234	-57.9234	-54.9234	-54.9234	-57.9234	-57.9234	-54.9234	-54.9234	-57.9234	-57.9234	-54.9234	-54.9234	-57.9234	-57.9234	-54.9234	-54.9234	-57.9234	-57.9234	-54.9234	-54.9234	-57.9234	-57.9234	-54.9234	-54.9234	-57.9234	-57.9234	-54.9234	-54.9234	-57.9234	-57.9234	-54.9234	-54.9234	-57.9234	-57.9234	-54.9234	-54.9234	-57.9234	-57.9234	-54.9234	-54.9234	-57.9234	-57.9234	-54.9234	-54.9234	-57.9234	-57.9234	-54.9234	-54.9234	-57.9234	-57.9234	-54.9234	-54.9234	-37.4234	-37.4234	-40.4234	-40.4234	-37.4234	-37.4234	-40.4234	-40.4234	-37.4234	-37.4234	-40.4234	-40.4234	-37.4234	-37.4234	-40.4234	-40.4234	-37.4234	-37.4234	-40.4234	-40.4234	-37.4234	-37.4234	-40.4234	-40.4234	-37.4234	-37.4234	-40.4234	-40.4234	-37.4234	-37.4234	-40.4234	-40.4234	-37.4234	-37.4234	-40.4234	-40.4234	-37.4234	-37.4234	-40.4234	-40.4234	-37.4234	-37.4234	-40.4234	-40.4234	-37.4234	-37.4234	-40.4234	-40.4234	-37.4234	-37.4234	-40.4234	-40.4234	-37.4234	-37.4234	-40.4234	-40.4234	-37.4234	-37.4234	-19.9234	-19.9234	-22.9234	-22.9234	-19.9234	-19.9234	-22.9234	-22.9234	-19.9234	-19.9234	-22.9234	-22.9234	-19.9234	-19.9234	-22.9234	-22.9234	-19.9234	-19.9234	-22.9234	-22.9234	-19.9234	-19.9234	-22.9234	-22.9234	-19.9234	-19.9234	-22.9234	-22.9234	-19.9234	-19.9234	-22.9234	-22.9234	-19.9234	-19.9234	-22.9234	-22.9234	-19.9234	-19.9234	-22.9234	-22.9234	-19.9234	-19.9234	-22.9234	-22.9234	-19.9234	-19.9234	-22.9234	-22.9234	-19.9234	-19.9234	-22.9234	-22.9234	-19.9234	-19.9234	-22.9234	-22.9234	-19.9234	-19.9234	-1.8234	-1.8234	-1.7234	-1.7234	-5.4234	-5.4234	-1.7234	-1.7234	-5.4234	-5.4234	-1.7234	-1.7234	-5.4234	-5.4234	-1.7234	-1.7234	-5.4234	-5.4234	-1.7234	-1.7234	-5.4234	-5.4234	-1.7234	-1.7234	-5.4234	-5.4234	-1.7234	-1.7234	-5.4234	-5.4234	-1.7234	-1.7234	-5.4234	-5.4234	-1.7234	-1.7234	-5.4234	-5.4234	-1.7234	-1.7234	-5.4234	-5.4234	-1.7234	-1.7234	-5.4234	-5.4234	-1.7234	-1.7234	-5.4234	-5.4234	-1.7234	-1.7234	-5.4234	-5.4234	-1.7234	-1.7234	-5.4234	-5.4234	-1.8234	-1.8234	-71.0234	-71.0234	-1.8234	-1.8234	-1.7234	-1.7234	7.0766	7.0766	4.0766	4.0766	7.0766	7.0766	4.0766	4.0766	7.0766	7.0766	82.1766	82.1766	12.9766	12.9766	16.5766	16.5766	12.8766	12.8766	16.5766	16.5766	12.8766	12.8766	16.5766	16.5766	12.8766	12.8766	16.5766	16.5766	12.8766	12.8766	16.5766	16.5766	12.8766	12.8766	16.5766	16.5766	12.8766	12.8766	16.5766	16.5766	12.8766	12.8766	16.5766	16.5766	12.8766	12.8766	16.5766	16.5766	12.8766	12.8766	16.5766	16.5766	12.8766	12.8766	16.5766	16.5766	12.8766	12.8766	16.5766	16.5766	12.8766	12.8766	16.5766	16.5766	12.8766	12.8766	16.5766	16.5766	12.8766	12.8766	16.5766	16.5766	34.0766	34.0766	31.0766	31.0766	34.0766	34.0766	31.0766	31.0766	34.0766	34.0766	31.0766	31.0766	34.0766	34.0766	31.0766	31.0766	34.0766	34.0766	31.0766	31.0766	34.0766	34.0766	31.0766	31.0766	34.0766	34.0766	31.0766	31.0766	34.0766	34.0766	31.0766	31.0766	34.0766	34.0766	31.0766	31.0766	34.0766	34.0766	31.0766	31.0766	34.0766	34.0766	31.0766	31.0766	34.0766	34.0766	31.0766	31.0766	34.0766	34.0766	31.0766	31.0766	34.0766	34.0766	31.0766	31.0766	34.0766	34.0766	51.5766	51.5766	48.5766	48.5766	51.5766	51.5766	48.5766	48.5766	51.5766	51.5766	48.5766	48.5766	51.5766	51.5766	48.5766	48.5766	51.5766	51.5766	48.5766	48.5766	51.5766	51.5766	48.5766	48.5766	51.5766	51.5766	48.5766	48.5766	51.5766	51.5766	48.5766	48.5766	51.5766	51.5766	48.5766	48.5766	51.5766	51.5766	48.5766	48.5766	51.5766	51.5766	48.5766	48.5766	51.5766	51.5766	48.5766	48.5766	51.5766	51.5766	48.5766	48.5766	51.5766	51.5766	48.5766	48.5766	51.5766	51.5766	69.0766	69.0766	66.0766	66.0766	69.0766	69.0766	66.0766	66.0766	69.0766	69.0766	66.0766	66.0766	69.0766	69.0766	66.0766	66.0766	69.0766	69.0766	66.0766	66.0766	69.0766	69.0766	66.0766	66.0766	69.0766	69.0766	66.0766	66.0766	69.0766	69.0766	66.0766	66.0766	69.0766	69.0766	66.0766	66.0766	69.0766	69.0766	66.0766	66.0766	69.0766	69.0766	66.0766	66.0766	69.0766	69.0766	66.0766	66.0766	69.0766	69.0766	66.0766	66.0766	69.0766	69.0766	66.0766	66.0766	69.0766	69.0766	82.1766	82.1766	12.9766	12.9766	82.1766	82.1766	86.5766	86.5766	83.5766	83.5766	86.5766	86.5766	83.5766	83.5766	86.5766	86.5766	83.5766	83.5766	86.5766	86.5766	83.5766	83.5766	86.5766	86.5766	83.5766	83.5766	86.5766	86.5766	83.5766	83.5766	86.5766	86.5766	83.5766	83.5766	86.5766	86.5766	83.5766	83.5766	86.5766	86.5766	83.5766	83.5766	86.5766	86.5766	83.5766	83.5766	86.5766	86.5766	83.5766	83.5766	86.5766	86.5766	83.5766	83.5766	86.5766	86.5766	83.5766	83.5766	86.5766	86.5766	83.5766	83.5766	86.5766	86.5766	90.8766	90.8766	87.8766	87.8766	90.8766	90.8766	87.8766	87.8766	90.8766	90.8766	165.6766	165.6766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	102.8766	102.8766	99.8766	99.8766	102.8766	102.8766	99.8766	99.8766	102.8766	102.8766	99.8766	99.8766	102.8766	102.8766	99.8766	99.8766	102.8766	102.8766	119.1766	119.1766	116.1766	116.1766	119.1766	119.1766	116.1766	116.1766	119.1766	119.1766	116.1766	116.1766	119.1766	119.1766	116.1766	116.1766	119.1766	119.1766	120.4766	120.4766	135.4766	135.4766	132.4766	132.4766	135.4766	135.4766	132.4766	132.4766	135.4766	135.4766	132.4766	132.4766	135.4766	135.4766	132.4766	132.4766	135.4766	135.4766	151.7766	151.7766	148.7766	148.7766	151.7766	151.7766	148.7766	148.7766	151.7766	151.7766	148.7766	148.7766	151.7766	151.7766	148.7766	148.7766	151.7766	151.7766	165.6766	165.6766	168.0766	168.0766	165.0766	165.0766	168.0766	168.0766	165.0766	165.0766	168.0766	168.0766	165.0766	165.0766	168.0766	168.0766	165.0766	165.0766	165.6766	165.6766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	96.4766	96.4766	120.4766	120.4766	165.6766	165.6766	168.0766	168.0766	175.1766	175.1766	172.1766	172.1766	175.1766	175.1766	172.1766	172.1766	175.1766	175.1766	179.9766	179.9766	187.8766	187.8766	187.9766	188.1766	188.4766	188.8766	189.3766	189.8766	191.8766	191.8766	189.8766	189.3766	188.8766	188.4766	188.1766	187.9766	187.8766	187.8766	179.9766	179.9766	183.9766	183.9766	179.9766	179.9766	187.8766	187.8766	187.9766	188.1766	188.4766	188.8766	189.3766	189.8766	191.8766	191.8766	189.8766	189.3766	188.8766	188.4766	188.1766	187.9766	187.8766	187.8766	179.9766	179.9766	-168.8234	-168.8234	-176.7234	-176.7234	-176.8234	-177.0234	-177.3234	-177.7234	-178.2234	-178.7234	-180.7234	-180.7234	-178.7234	-178.2234	-177.7234	-177.3234	-177.0234	-176.8234	-176.7234	-176.7234	-168.8234	-168.8234	-176.7234	-176.7234	-176.8234	-177.0234	-177.3234	-177.7234	-178.2234	-178.7234	-180.7234]';

% geometric properties
xg  = zeros(length(xy),1);
yg  = zeros(length(xy),1);
A   = zeros(length(xy),1);
Ixx = zeros(length(xy),1);
Iyy = zeros(length(xy),1);
for ii = 1 : length(xy)
    [xg(ii), yg(ii), A(ii), Ixx(ii), Iyy(ii)] = area_properties(xy{ii}(:,1), xy{ii}(:,2));
end

% create joints (start and end coordinates of each beam)
L0 = 65.2;
L1 = L0 + p(1);
xy{1}(:,2) = xy{1}(:,2) + p(1);
joints{1} = [-183.964, 191.877;
             -183.964, 191.877+L1];

L2 = L0 + p(2);
joints{2} = [-43.9 214.977+p(1);
             -43.9 214.997+p(1)+L2];

L3 = L0 + p(3);
xy{2}(:,2) = xy{2}(:,2) + p(3);
joints{3} = [196.036, 191.877;
             196.036, 191.877+L3];

L4 = L0 + p(4);
joints{4} = [56.036, 214.997+p(3);
             56.036, 214.997+p(3)+L4];

L5 = L0 + p(5);
xy{3}(:,2) = xy{3}(:,2) - p(5);
joints{5} = [196.036, -180.723;
             196.036, -180.723-L5];

L6 = L0 + p(6);
joints{6} = [56.036, -203.823-p(5);
             56.036, -203.823-p(5)-L6];

L7 = L0 + p(7);
xy{4}(:,2) = xy{4}(:,2) - p(7);
joints{7} = [-183.964, -180.723;
             -183.964, -180.723-L7];

L8 = L0 + p(8);
joints{8} = [-43.964, -203.823-p(7);
             -43.964, -203.823-p(7)-L8];

% add a column to define the mass the joints are attached to or to specify
% if the joint is clamped (-1). If an internal joint (e.g. as in a folded
% beam), put 0.
joints{1}(:,3) = [5 1];
joints{2}(:,3) = [1 -1];
joints{3}(:,3) = [5 2];
joints{4}(:,3) = [2 -1];
joints{5}(:,3) = [5 3];
joints{6}(:,3) = [3 -1];
joints{7}(:,3) = [5 4];
joints{8}(:,3) = [4 -1];

% specify the constrained DOFs for each mass (1=fixed, 0=free)
mass_constraints = [...
    0 0 0       % 1: top-left beam
    0 0 0       % 2: top-right beam
    0 0 0       % 3: bottom-right beam
    0 0 0       % 4: bottom-left beam
    0 0 0];     % 5: central mass

model.joints = joints;
model.xg  = xg;
model.yg  = yg;
model.mass_constraints = mass_constraints;
model.xy  = xy;
model.A   = A;
model.Ixx = Ixx;
model.Iyy = Iyy;

% PLOT GEOMETRY
if plot_geom == 1
    figure
    hold on
    % plot mass shapes
    for ii = 1 : length(xy)
        patch(xy{ii}(:,1),   xy{ii}(:,2),  'k','EdgeColor','none')
    end
    % plot joints and tags
    for ii = 1 : length(joints)
        plot(joints{ii}(:,1), joints{ii}(:,2),'r','LineWidth',2)
        text(mean(joints{ii}(:,1)), mean(joints{ii}(:,2)), num2str(ii),'HorizontalAlignment','center')
        % plot mass-joint (master-slave) connection lines
        for jj = 1 : size(joints{ii},1)
            nm = joints{ii}(jj,3);  % mass number
            if nm==0 % internal joint
                continue
            end
            xs = joints{ii}(jj,1);  % x slave
            ys = joints{ii}(jj,2);  % y slave
            if nm==-1 % clamped joint
                plot(xs, ys, 'ks', 'MarkerFaceColor','k',MarkerSize=7)
                continue
            end
            xm = xg(nm);            % x master
            ym = yg(nm);            % y master
            plot([xs xm],[ys ym],'--','LineWidth',1)
        end
    end
    
    % plot mass tags
    for ii = 1 : length(xy)
        hold on
        plot(xg(ii), yg(ii), 'ko', 'MarkerFaceColor','y',MarkerSize=10)
        text(xg(ii), yg(ii), num2str(ii),'HorizontalAlignment','center')
    end
    axis equal
    axis off
end

